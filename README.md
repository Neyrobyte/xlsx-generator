# xlsx-generator
Generate excel tables from simple text data. Additional tool for AI

# Документация
## Для пользователей
### Назначение скрипта
Этот скрипт преобразует текстовые файлы в форматированные Excel-файлы (XLSX) с автоматическим применением стилей:
- Автоматическое определение типов данных (числа, даты, текст)
- Цветовое выделение разных типов данных
- Форматирование границ и заголовков
- Автоподбор ширины столбцов

### Требования
- Python 3.6 или новее
- Установленные зависимости: `openpyxl`

### Установка зависимостей
```bash
pip install openpyxl
```

### Использование
1. Создайте текстовый файл `xlsx_generate.txt` в той же папке, где находится скрипт
2. Заполните его данными по описанному ниже формату
3. Запустите скрипт: `python script_name.py`
4. Результат будет сохранен в `storage/shared/download/output.xlsx`

### Формат входного файла
Файл должен содержать данные в следующем формате:
```
sheet:ИмяЛиста1
Заголовок1;Заголовок2;Заголовок3
Значение1;Значение2;Значение3
42;2023-01-01;Текст

sheet:ИмяЛиста2
ДругойЗаголовок1;ДругойЗаголовок2
100;Пример текста
```

#### Особенности формата:
- Разделитель листов - пустая строка
- Имя листа указывается в строке `sheet:ИмяЛиста`
- Данные разделяются точкой с запятой (`;`)
- Поддерживаются специальные форматы для ячеек:
  - Даты: `YYYY-MM-DD`, `DD/MM/YYYY`, `DD.MM.YYYY`
  - Формулы Excel: `{"value": "=SUM(A1:A10)"}`
  - JSON-формат для сложных значений: `{"value": "текст"}`

### Результат работы
Скрипт создаст Excel-файл со следующими особенностями:
- Заголовки с серым фоном и жирным шрифтом
- Первый столбец с светло-серым фоном
- Числовые столбцы с чередующимися бледно-голубым и бледно-синим фоном
- Текстовые столбцы с чередующимися бледно-зеленым и бледно-оранжевым фоном
- Столбцы с датами с бледно-фиолетовым фоном
- Толстые внешние границы таблицы
- Автоподобранная ширина столбцов

## Для разработчиков

### Архитектура скрипта
Скрипт состоит из следующих основных функций:
1. `parse_input_file` - парсинг входного текстового файла
2. `apply_default_styles` - применение стилей к листу Excel
3. `generate_xlsx` - основная функция генерации файла

### Конфигурация стилей
Стили определяются в словаре `DEFAULT_STYLES` в начале скрипта. Можно изменять:
- Цвета заливки
- Настройки шрифтов
- Границы
- Выравнивание текста

### Расширение функциональности
1. **Добавление новых типов данных**:
   - Реализуйте новую функцию проверки типа (по аналогии с `is_number` и `is_date`)
   - Добавьте соответствующий стиль в `DEFAULT_STYLES`
   - Модифицируйте логику в `apply_default_styles`

2. **Изменение формата входных данных**:
   - Модифицируйте функцию `parse_input_file`
   - Обновите документацию для пользователей

3. **Добавление новых стилей**:
   - Используйте методы библиотеки `openpyxl.styles`
   - Добавьте новые параметры в `DEFAULT_STYLES`

### Тестирование
Для тестирования изменений:
1. Создайте тестовый входной файл
2. Запустите скрипт
3. Проверьте результат в выходном файле

### Обработка ошибок
Скрипт обрабатывает основные ошибки:
- Отсутствие входного файла
- Ошибки парсинга JSON
- Ошибки форматирования дат

Для добавления новой обработки ошибок модифицируйте блок `try-except` в функции `generate_xlsx`.

### Зависимости
- `openpyxl` - для работы с Excel-файлами
- Стандартные библиотеки Python: `datetime`, `re`, `json`, `os`

### Совместимость
Скрипт тестировался на:
- Python 3.6+
- OpenPyXL 3.0+
